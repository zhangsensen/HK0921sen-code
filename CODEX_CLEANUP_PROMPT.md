# 重构记录与后续守则

## 调整概览

- 已移除 `hk_factor_discovery/` 内的重复实现，所有核心代码现位于仓库根目录。
- 兼容性包装器被删除，导入路径统一为顶层模块（如 `application`, `phase1`, `utils` 等）。
- 代码中依赖的相对导入全部替换为新的绝对路径，确保在脚本与包场景下均可运行。
- 新增 `__init__.py` 以维持易用的聚合导出，同时避免隐式命名空间带来的兼容风险。
- 文档、示例与测试均已更新，反映扁平化后的结构。

## 目前的目录形态

```
HK0920sen-code/
├── application/
├── config.py
├── data_loader.py
├── data_loader_optimized.py
├── database.py
├── factors/
├── main.py
├── phase1/
├── phase2/
├── utils/
└── tests/
```

## 后续维护建议

1. **保持单一实现**：新增模块时直接放在顶层目录，避免再引入兼容性包装器。
2. **导入约定**：
   - 内部模块优先使用顶层绝对导入，例如 `from utils.cache import InMemoryCache`。
   - 若需要聚合导出，可在对应包的 `__init__.py` 内维护 `__all__`。
3. **文档同步**：提交影响公共 API 的改动时，务必同步更新 README 与 docs/* 中的示例代码。
4. **测试要求**：任何结构性调整都应运行 `pytest` 作为冒烟验证，确保核心探索与组合逻辑保持稳定。
5. **废弃路径**：旧的 `hk_factor_discovery.*` 导入已不可用，如需兼容外部项目，请单独提供迁移指引。

## 检查清单（提交前）

- [ ] 没有新增与旧实现功能重复的文件
- [ ] 所有导入均指向新的顶层模块
- [ ] 文档与示例反映最新结构
- [ ] `pytest` 或最小化冒烟测试通过
- [ ] 必要时在 `CHANGELOG` / PR 描述中说明破坏性变更

遵循以上规则，可以让扁平化后的项目结构保持简洁且易于维护。EOF
